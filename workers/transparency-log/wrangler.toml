name = "wares-transparency-log"
main = "src/index.js"
compatibility_date = "2024-01-01"

# Enable workers.dev subdomain for testing
workers_dev = true

# Path-based routing: wares.lumen-lang.com/log/*
# The transparency log is served under the main wares domain, not a separate subdomain.

# D1 Database for storing log entries
[[d1_databases]]
binding = "wares_transparency_log"
database_name = "wares-transparency-log"
database_id = "222b303b-3e32-43a0-be42-24b480d78201"

# Environment variables
[vars]
# Set via wrangler secret put REGISTRY_API_KEY
# REGISTRY_API_KEY = "your-secret-api-key"

# Path-based routing under wares.lumen-lang.com/log/*
# This avoids TLS issues with sub-subdomains and keeps all APIs under one domain.

# Deploy with: wrangler deploy
# Then configure route: wares.lumen-lang.com/log/* â†’ this worker
# The WARES_LOG_URL env var can override: defaults to https://wares.lumen-lang.com/log
